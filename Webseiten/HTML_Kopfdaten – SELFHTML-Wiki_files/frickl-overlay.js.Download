(window.RLQ = window.RLQ||[]).push(function() {
$(function() {
 	var iframe, overlay, x;

	// prepare document
	function setup () {
		// add stylesheet
		$("head").append(
			'<link rel="stylesheet" type="text/css" media="screen" href="'
			+ $('script[src*="js/frickl-overlay.js"]').attr("src").replace(/\/js\/frickl-overlay.js.*/, "/css/")
			+ 'frickl-overlay.css" />'
		);

		// equip all example links with frickl functionality
		$('a[href*="extensions/Selfhtml/example.php/Beispiel:"]')
		.click(function (e) {
			e.preventDefault();
			load(e.target.href.replace(/\/example\.php\//, "/frickl.php/"));
		});

		// resize iframe
		$(window).on("resize", function () {

			if (overlay && overlay.parent().length > 0) {

				iframe.css({
					height: (overlay.height() -60) + "px",
					width:  (overlay.width() -40) + "px"
				});
			}
		});
	}

	// load example into iframe
	function load (url) {
		iframe = $('<iframe src="'+url+'">');
		overlay = $('<div id="frickl">')
			.hide()
			.appendTo("body");
		x = $('<div title="schließen">×</div>');

		iframe.css({
			height: (overlay.height() -60) + "px",
			width:  (overlay.width() -40) + "px"
		});

		x.on("click", function () {
			overlay.fadeOut({
				complete: function () {
					overlay.remove();
				}
			})
		});

		overlay.append(iframe);
		overlay.append(x);
		overlay.fadeIn();
	}

	setup();
});
});
